<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <title>Resultado de búsqueda</title>
    <link rel="icon" type="image/x-icon" th:href="@{/img/favicon.ico}" />

    <!-- Boostrap core css -->
    <link rel="stylesheet" th:href="@{/webjars/bootstrap/5.2.0/css/bootstrap.min.css}"/>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css">

    <!-- custom style -->
    <link rel="stylesheet" th:href="@{/css/formulario-envio.css}"/>
    <link rel="stylesheet" th:href="@{/css/categorias.css}"/>
</head>

<body>

<!-- Header -->
<div th:replace="~{fragments/header :: userHeader}"></div>

<div class="container formulario-envio">
    <h2>Simulador de Envío</h2>
    <br>

    <h5>Domicilio de entrega</h5>

    <form th:action="@{/calcular-envio}" th:object="${envio}" method="post">
        <div>
            <label>País:</label>
            <select th:field="*{pais}" required>
                <option value="" disabled>Seleccionar país</option>
                <option value="Argentina">Argentina</option>
            </select>
        </div>

        <div>
            <label>Provincia:</label>
            <input th:field="*{provincia}" placeholder="Ej: Buenos Aires" required>
        </div>

        <div>
            <label>Ciudad:</label>
            <input th:field="*{ciudad}" required>
        </div>

        <div>
            <label>Código Postal:</label>
            <input type="number" th:field="*{codigoPostal}" required>
        </div>
<br>
        <h5>Datos del producto</h5>

        <input type="hidden" id="calcular" name="calcular" value="">

        <label>Subasta:</label>
        <select name="subastaId" onchange="document.getElementById('calcular').value=''; this.form.submit();">
            <option value="" disabled selected>Seleccionar subasta</option>
            <option th:each="subasta : ${subastas}"
                    th:value="${subasta.id}"
                    th:text="'Subasta #' + ${subasta.id}"
                    th:selected="${subasta.id} == ${subastaId}">
            </option>
        </select>



        <div>
            <label>Peso(kg):</label>
            <small class="form-text text-muted">Solo informativo, no afecta el costo.</small>
            <input type="number" step="0.1" th:field="*{peso}" required>
        </div>

        <div>
            <label>Largo(cm):</label>
            <input type="number" step="0.1" th:field="*{largo}" required>
        </div>

        <div>
            <label>Ancho(cm):</label>
            <input type="number" step="0.1" th:field="*{ancho}" required>
        </div>

        <div>
            <label>Alto(cm):</label>
            <input type="number" step="0.1" th:field="*{alto}" required>
        </div>

        <button type="submit" onclick="document.getElementById('calcular').value='true'">Calcular envío</button>
    </form>

    <div th:if="${error}" class="alert alert-danger">
        <p th:text="${error}"></p>
    </div>

    <hr>

    <div th:if="${resultado}">
        <h4>Resultado del Envío</h4>
        <p>Tamaño del paquete: <strong th:text="${resultado.tamanio}"> </strong></p>
        <p>Zona/pais destino: <strong th:text="${resultado.zonaDestino}"> </strong></p>
        <p>Costo: <strong>$<span th:text="${resultado.costo}"></span></strong></p>
        <p>Días estimados de entrega: <strong><span th:text="${resultado.diasDeEntrega}"> </span> días</strong></p>
    </div>
</div>

<!-- Footer -->
<div th:replace="~{fragments/footer :: footer}"></div>

<!-- Boostrap core js -->
<script type="text/javascript" th:src="@{webjars/bootstrap/5.2.0/js/bootstrap.min.js}"></script>
</body>
</html>