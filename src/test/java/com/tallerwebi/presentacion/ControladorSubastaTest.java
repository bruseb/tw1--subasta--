package com.tallerwebi.presentacion;

import com.tallerwebi.dominio.*;
import com.tallerwebi.exception.UsuarioNoDefinidoException;

import org.junit.jupiter.api.BeforeEach;
import org.junit.jupiter.api.Test;
import org.springframework.web.multipart.MultipartFile;
import org.springframework.web.servlet.ModelAndView;

import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpSession;
import java.io.IOException;

import static org.hamcrest.MatcherAssert.assertThat;
import static org.hamcrest.text.IsEqualIgnoringCase.equalToIgnoringCase;
import static org.mockito.ArgumentMatchers.any;
import static org.mockito.ArgumentMatchers.anyString;
import static org.mockito.ArgumentMatchers.isNull;
import static org.mockito.Mockito.*;
import org.springframework.mock.web.MockMultipartFile;
import org.springframework.web.multipart.MultipartFile;

public class ControladorSubastaTest {
    private ControladorSubasta controladorSubasta;
    private ServicioSubasta servicioSubastaMock;
    private HttpServletRequest requestMock;
    private HttpSession sessionMock;
    private Subasta subastaMock;

    private ServicioCategorias servicioCategoriasMock;
    private ServicioSubcategoriasImpl servicioSubcategoriasMock;
    private ServicioPerfil servicioPerfilMock;
    private RepositorioSubasta repositorioSubastaMock;
    private MockMultipartFile mockFile1;
    private MockMultipartFile mockFile2;
    private MultipartFile[] multipartFileMock;


    @BeforeEach
    public void init() {
        subastaMock = new Subasta();
        subastaMock.setEstadoSubasta(4);

        servicioSubastaMock = mock(ServicioSubasta.class);
        requestMock = mock(HttpServletRequest.class);
        sessionMock = mock(HttpSession.class);
        servicioCategoriasMock = mock(ServicioCategorias.class);
        servicioSubcategoriasMock = mock(ServicioSubcategoriasImpl.class);
        servicioPerfilMock = mock(ServicioPerfil.class);
        when(requestMock.getSession()).thenReturn(sessionMock);
        controladorSubasta = new ControladorSubasta(servicioSubastaMock,servicioSubcategoriasMock,servicioCategoriasMock,repositorioSubastaMock,servicioPerfilMock);
        //multipartFileMock = mock(MultipartFile[].class);

    }

    @Test
    public void crearSubastaDebeLlevarAconfirmacionCreacionDeSubasta() throws IOException {
        // preparación
        when(sessionMock.getAttribute("USUARIO")).thenReturn("aguspucci@unlam.com");
        when(requestMock.getSession()).thenReturn(sessionMock);
        mockFile1 = new MockMultipartFile("mockFile1", "mockFile1", "image/jpeg", "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".getBytes());
        mockFile2 = new MockMultipartFile("mockFile2", "mockFile2", "image/jpeg", "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".getBytes());
        multipartFileMock = new MultipartFile[]{mockFile1, mockFile2};

        // ejecución
        ModelAndView vista = controladorSubasta.crearSubasta(subastaMock,multipartFileMock, 100F, requestMock);

        // validacion
        assertThat(vista.getViewName(), equalToIgnoringCase("redirect:/confirmacion-subasta"));
    }

    @Test
    public void crearSubastaCuandoServicioLanzaExcepcionImagenNoDefinidaDevuelveVistaNuevaSubastaConError() throws IOException {
        // preparación
        when(requestMock.getSession()).thenReturn(sessionMock);
        when(sessionMock.getAttribute("USUARIO")).thenReturn("aguspucci@unlam.com");
        multipartFileMock = new MultipartFile[]{};

        // Configuración para lanzar la excepción
        doThrow(new RuntimeException("Imagen no definida."))
                .when(servicioSubastaMock)
                .crearSubasta(any(Subasta.class), any(MultipartFile[].class), anyString());

        // ejecución
        ModelAndView vista = controladorSubasta.crearSubasta(subastaMock,multipartFileMock, 100F, requestMock);

        // validación
        assertThat(vista.getViewName(), equalToIgnoringCase("nuevaSubasta"));
        assertThat(String.valueOf(vista.getModel().get("error")), equalToIgnoringCase("Imagen no definida."));
    }

    @Test
    void crearSubastaServicioCuandoLanzaUsuarioNoDefinidoMuestraError() throws Exception {
        // preparación
        when(requestMock.getSession()).thenReturn(sessionMock);
        when(sessionMock.getAttribute("USUARIO")).thenReturn(null); // email nulo
        mockFile1 = new MockMultipartFile("mockFile1", "mockFile1", "image/jpeg", "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".getBytes());
        mockFile2 = new MockMultipartFile("mockFile2", "mockFile2", "image/jpeg", "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".getBytes());
        multipartFileMock = new MultipartFile[]{mockFile1, mockFile2};

        doThrow(new UsuarioNoDefinidoException("Usuario no definido."))
                .when(servicioSubastaMock)
                .crearSubasta(any(Subasta.class), any(MultipartFile[].class), any());

        // ejecución
        ModelAndView vista = controladorSubasta.crearSubasta(subastaMock,multipartFileMock, 100F, requestMock);

        // validacion
        assertThat(vista.getViewName(), equalToIgnoringCase("nuevaSubasta"));
        assertThat(String.valueOf(vista.getModel().get("error")), equalToIgnoringCase("Usuario no definido."));
    }

    @Test
    public void crearSubastaCuandoServicioLanzaExcepcionCategoriaNoDefinida() throws IOException {
        // preparación
        when(sessionMock.getAttribute("USUARIO")).thenReturn("aguspucci@unlam.com");
        when(requestMock.getSession()).thenReturn(sessionMock);
        mockFile1 = new MockMultipartFile("mockFile1", "mockFile1", "image/jpeg", "/9j/4AAQSkZJRgABAQAAAQABAAD/2wBDAAoHCAkIBgoJCAkMCwoMDxoRDw4ODx8WGBMaJSEnJiQhJCMpLjsyKSw4LCMkM0Y0OD0/QkNCKDFITUhATTtBQj//2wBDAQsMDA8NDx4RER4/KiQqPz8/Pz8/Pz8/Pz8/Pz8/Pz8/Pz8/Pz8/Pz8/Pz8/Pz8/Pz8/Pz8/Pz8/Pz8/Pz8/Pz//wAARCACWAJYDAREAAhEBAxEB/8QAGwAAAgMBAQEAAAAAAAAAAAAAAgMBBAUABwb/xAA6EAACAQIEAwYDBgUEAwAAAAABAhEAAwQSITEFQVETIjJhcYEUobEGM5HB0fAVI0JiciRSc+E0Y/H/xAAYAQEBAQEBAAAAAAAAAAAAAAAAAQIDBP/EAB4RAQADAQEBAQEBAQAAAAAAAAABAhESMSEDUQQT/9oADAMBAAIRAxEAPwD5xWrzugg1FEGqK4vVCi1QRm0oALUCy1VCWagUWoAzd6qGq1QGpoDBoCBqKdaOtUb/AAs6CoPqMGdBWoRq2j3a2jyENXMFnoOL0VGfzoBziggvQLL0AM9AlmqoWWoAza0DFagNXqA1eijDUDrba0V9Dws6CoPpsI2grSNW03drUSjx4PWRPaVBGegjPFXDQm4OtMTYAbw61eZOoAbwq8ynUANwnYGrwnUAYt0NOE6Ac/SrwdBAedqcnQwT0NZ5lroQJqcyaYGIqYujV6KfafWor6Lhjd0VFfS4R9BVGpbfu1UePd6unDl0IK5EgU4TpIs3G2BrXCdmLg7hPOrFU6MHDnJ2NXlNT/DwvjIHqaZEH1IwlnndQe9NgyRrgrf9Lofer8MkfwAOwn0q5CaIcPWNVM0xNSvDgB4auGp/h45LTDXfw4RJApya4cOVt1qcwvUlvwtdYMVmfzhqLyBeHONVNYn8/wCNR+jTwU2oDcq5zSYdIvDfwd0EDWpktbDUt3NKK+IThgjUTXs5ePT7fDV5inJqwmAC6AVcRaNvgmCATG40/EHdLayE9T1rnNv46RX+k3MPw/EAnD8RT0bSsTOtxEELwq4jZ7Rw9/SIJqYqrisDiQpAwmXn3NRUxdZNzD48EjtFtr/xkmmJspw9lrTHPiGuM0b6Ae1BZD3l8Nxx6GrspkDGMxKiO0n1ANXqU5ga8RvjRktt7RV7lOIH/FOT4f8ABqv/AETga8SsEEMlxfYGr3CcSn47BRDXcs/7lIq91TmVm2EuJnssrqeamRW4+sj7PkRTAajIO6TNZyF2TreJujQMazP5xLUXmF1LYJJy+9dnMQsCTUFbHN8Pgr1xfEiEj1qW8WvrzHG4xrd7UZ3bvEk1wiHYpeIMvitkehpgfY4s6GRfur0FMGnh/tHik8OKn/I1FXrf2lxDL/MVLg9JoDxnH8BYs5cRYD4k/wBCAAJ6nr5Daqaxv41auNI7vkAKmGmJxFGHjA9yKYHJjJ2IPoQagg4tQCTE+sUVXuY+0BGxojPv4tnJg6UDuE8Su8Pxq3QxNpiBdSdCOvqK1WclmY2HoSsrEQN+dehxHAPKqJZY2iiNrsgoMamigyQdKClxVQeE4rSD2bVm3i19eSY4f6lf8R9TXGHWV8IpQSAdOlaxnS2wtkjVR7aVMNV2wVo7Fl+dRdRh82FxYAbMCpI9RtRYlRE3r5k7moqw2FQLJaPWgX8Mw8LfUUHZMQnMn50BW775styQeRoOuS2p3GhFRXKe7rypiHX8NfsWVe9aZFuAlc2k1cHpuDXLh7QYRCKPlXpcDoInKRRBKg5a0GuSuaCaKhbWYkzpNBU4lP8AD8SkT/KbX2qT4sevIOIffof7fzrhDrLRtrNtfStuYyFiKBRUcqiqd4RjF/4zUlqFDDfeSdhrWWlnPLFn0AGp+gFBDusSLYA/tJkUUyzc2Eyp0BogMYsWw3OaALnjbzUUFzgiB8U6lFZjbfKW2UxoaB/FVY4m3aNq4gZiZutLuSQMxHLbQdKsJL0NQEEchXpcDNmBnfkKgksCYzaig1TBTvGfaqrgwzaEgxtFQIxzzhryldTbYTGmxqT4sT9eOcR++T0/OuEOstK0xFpdOVbc3EnoKASZoKV8/wCsH/EazLdWfYE5vSstHXvuz/n+WlBKsDbCqu+5iaAE8bL5GgdjDmsIf90GgG594/oBVRa4ZcSwbtxrzWiEhcqyW1Gg6bb0DcO3xnGcNCxmvKNTJPenU8zVr6k+PTEIIjeu7ihgmpmPSgi32aEgvQbEKQWGh6nnRSyzSVKEg9eVUKupNm4qSsodAZ5VJIePcTEXEPLUfOvPDtK1YuB7Kww0GutdIczG12FABPWoKl7/AMuP/WazLdVPCfeCay0sXLcArEiPlyNAgWn2RgR1mKoNLUMVDAuRrGwFA3GrHZIORioFXPHc9aqBLFVAG519KI1Ps2mfjmEDGQLhafQE1qvqW8ekqcoEwdNSK7OSTDgjNp5UAMpGoKkdTzoNa4JeCdCZ0oqGJfRFZYOubeaAWAysCCDGwoPJcQiu7q4kZjXmdyrnDgtpbqm7aRjCswlSfWrqYULWLtj+XcW4Ogb8jV1MCcVctmL9or6iKupiLTi9jARMBSDWZagprL27pKCdZAqKZ8SPDdtsp8qA1fDOe8w911oHgoqRZSP7tPkBQVMSZv2l5gzQIdu+3m1VEE9/0UUG99kUL8atkDwW3b5R+dbp6xbx98Lik+EabMv611c3BwwJgHUxl3oDXLcAKAN5NRWndYdpq+sx3aBJvlhnaQRoPUen1oOzgABSzQdlNB5lxSw+F4nfs3FIIckTzB1FcJjJdonYXsFfwicPtzct/F5gmW4kiC/Xymd661pS1ffrha/6Vv8AI+LOIw4F8YYYS1iCF7RnDgM4Jga5d9Ks/wCe25H1mv8AqpztvjKvWLa4drlu46gTCvGsNEeZ57RXGazHsPRF628lTzcgFHooH0rLQWCsIYTQJuB1HdOYdGE0FfNabx2o80MVRK2rRPcvlP8AIfpQE4w+HXMt037p5xAH46mgpAnMSd6BgjNJoj6X7HnLjcTdjw2gJjaW/wCq6UYs+uN8BVVhrzhvP/utuZgvEklh3CByA9hVVLFH/wBz+an5aUGqrkWwEUkHf23+dAIzMzEAztMiCKBYDWTNtwQviSdh6/WgyeK8NwvFcOZJ+JURbcNqNJg9RUmNWJx8Vi+GcTwSzewxdNIZDM1ymkukWhVs4xrFybb3LFwaaSppW1qzsSlq1vGWjVk4++/DzgyytaJBmNfFO/rW5/a805lzj8KRfuPVea4u7qDjqKCs1vvbc+k8z0oAa1QLa3FAhtCao7NRH0fAitjCsx+8uGdDqOgrpX4xb1prjHBLZx4pPU1rWFy3ixIBaOcTpV0W/i1BGXu+WaIoN3NdZ3a3ICgAwwA9+lUKZyqks+Y7kKZ06zt5+9APbDLOgy6d6df19fKgIZAG3yx4T3TPT8qAWGaZMxHLXz0/LzoKN7h2FxbZL9lHWea69Tr+FTIGFf8AsvhnZvhXu2jqBqCD+NZmkNRaWTiOCcSwwJXs7wG+VtazxLUXZ9x7lhsuItPbPmKxmNbqVuo2zCootIoIIoFuoAJoM5z3jVHKNagtW7hBkEg1WVm3iri7mZppiwmOYdKvScnrxAEQavSY9CLMQG1NxdwdhP7512YC4K3O4NBowBjXr5c6AFuAN37pZfXfX66fuKCZV5cTEyNZPlRQlgmoJyyIkbT18tNqIhQyCH0DankDzFAtypOuVuobWP3E0BqyP4mLMsnMSPcgbc/nQV8RhLV9lIBYEwwy6/vagy8XwDAYhMy4fs21h7U6ms8xKxMsXE/ZzEWS/wANiM4TUhxyrM0aizOu2MdhzF3DlvNdaxzLXUKV7EFhAUj1qNK4Uk60DVWogwsedAQHI0EgQaAgfKg9TbMzZ1IIBOrDkNZPn5Rz8q9LikE5Sot5iBGhBnrUCigtBkOXXbWdD70VHaKUzKZGgcroB5fh+VEc85gueF2gKIOm3sDVAqFtWxqM51DCdtveP+6CQhK5lgakhW/q1jnz6UC8vZspQMV0kZdRrvJ3k/SgaIQZSVYMYgiQOf76UC3uq5Bt8yCMsnbcj5fpQJlDnLKSADuRAPLTrQKuIAxJhmfduQ0IE9KCpe4bhrqk3LakyFXSf3oPnUyF1mYjglkKCinWTAEkddazzC6qXODKNbZJXSCDPt86nC9K78Pa0ZbrGpqcnQWwTRI261OV6d8C48QNOTQ/CNO1OTXptxrSg3DG0nMdPP3/AFrs5qxYkkESCJ3jWdSelBJXMQrOrBgRA68qARakG3GUZTAfwnTegIMEzAiV2hjEachQDdYq4Kq3ow2/Sgm53nuABu956v5+WvKgC4CpOYgs2hgwGG3p+sUAlVZzBMz4WMCOfp+VAKdm2sQiiTm0AE7+Y86Dm0IAK5pmNI6/SKBKM4BJYHLsDrlb896CRCkwzHNoWnfWghsvZuEBKloYxI3/AAoAcBgbiqCHhchEA+nWPSgrm0CSyox/tI27xiOZ9N6gr/DiSqsvd1BA55uQ/WgU2GGXMWJO++p9+dMUKYYHojDeY08vKpg+tTM5OwIAykrJB31P19q0iWVAVuQY0lNwvKenXTnUAMQA082OYHnH709J61RJRbZBfvLAyzoJnUfiNqBbHUsqjQZc22cE71B11/6kJuf0QNZM86og22SWXvK2hbc78/xNBylGtlFKl4KmTM8p8hP5zQKUmQ2dS8aZTpA038zQS+RoYSZMARqCOZPl0moEvpndgFDMCQrTM7R+nnVEdmcoMS2kE7QJM/jQcwYEMwdzuJiBoNPXTlpQCrsAO0Ihh3SdDz1/cUCwVc57ANqGkNs23IUBIe3YB1yZoOhJGnPp9aBTWigAugiR1g+vTfnQSDlRgoVRlEtGgEfhPzqBRw8kqpRAuktGvPn6z70G2l221y9aCsFTvAkyTJ2+tUMWTeNomZggkdRH5RUBKAVGUEBttYjSYopFtu/cUkkMwBIAB5ifaqg7YVw1phDyQGGwPWoF9oZKqiqBCxMjaR++tUDZUC52WjLIMMInzMbmfpQC9sWnLgAquaBEZcsD6mgLEThpykqdww1Ij/7QKsHt2VEHfbutmOkDf50EC2CwVgGXKXPKATGg60HOjkFmytcjMSRuOvrp6UACAQuiygLFV1iNI/SiFW2bNbLxNyZgc4PPf3+VAFwS8AmSxUE+1A97a9qFOzoGnmBP1oqUd0CFzKMYBJlgOkmgjEYbJcZUyhi2UyJ13BqCu9hSs3SWnWY1oP/Z".getBytes());
        mockFile2 = new MockMultipartFile("mockFile2", "mockFile2", "image/jpeg", "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".getBytes());
        multipartFileMock = new MultipartFile[]{mockFile1, mockFile2};

        // Configuración para lanzar la excepción
        doThrow(new RuntimeException("Categoria no definida."))
                .when(servicioSubastaMock)
                .crearSubasta(any(Subasta.class), any(MultipartFile[].class), anyString());

        // ejecución
        ModelAndView vista = controladorSubasta.crearSubasta(subastaMock,multipartFileMock, 100F, requestMock);

        // validacion
        assertThat(vista.getViewName(), equalToIgnoringCase("nuevaSubasta"));
        assertThat(String.valueOf(vista.getModel().get("error")), equalToIgnoringCase("Categoria no definida."));
    }

    @Test
    public void crearSubastaCuandoServicioLanzaExcepcionEstadoNoDefinido() throws IOException {
        // preparación
        when(sessionMock.getAttribute("USUARIO")).thenReturn("aguspucci@unlam.com");
        when(requestMock.getSession()).thenReturn(sessionMock);
        mockFile1 = new MockMultipartFile("mockFile1", "mockFile1", "image/jpeg", "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".getBytes());
        mockFile2 = new MockMultipartFile("mockFile2", "mockFile2", "image/jpeg", "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".getBytes());
        multipartFileMock = new MultipartFile[]{mockFile1, mockFile2};

        // Configuración para lanzar la excepción
        doThrow(new RuntimeException("Estado de subasta no valido."))
                .when(servicioSubastaMock)
                .crearSubasta(any(Subasta.class), any(MultipartFile[].class), anyString());

        // ejecución
        ModelAndView vista = controladorSubasta.crearSubasta(subastaMock,multipartFileMock, 100F, requestMock);

        // validacion
        assertThat(vista.getViewName(), equalToIgnoringCase("nuevaSubasta"));
        assertThat(String.valueOf(vista.getModel().get("error")), equalToIgnoringCase("Estado de subasta no valido."));
    }

    @Test
    public void crearSubastaCuandoServicioLanzaExcepcionMontoInicialNoPuedeSerNegativo() throws IOException {
        // preparación
        when(sessionMock.getAttribute("USUARIO")).thenReturn("aguspucci@unlam.com");
        when(requestMock.getSession()).thenReturn(sessionMock);
        mockFile1 = new MockMultipartFile("mockFile1", "mockFile1", "image/jpeg", "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".getBytes());
        mockFile2 = new MockMultipartFile("mockFile2", "mockFile2", "image/jpeg", "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".getBytes());
        multipartFileMock = new MultipartFile[]{mockFile1, mockFile2};

        // Configuración para lanzar la excepción
        doThrow(new RuntimeException("El monto inicial no puede ser negativo."))
                .when(servicioSubastaMock)
                .crearSubasta(any(Subasta.class), any(MultipartFile[].class), anyString());

        // ejecución
        ModelAndView vista = controladorSubasta.crearSubasta(subastaMock,multipartFileMock, -100F, requestMock);

        // validacion
        assertThat(vista.getViewName(), equalToIgnoringCase("nuevaSubasta"));
        assertThat(String.valueOf(vista.getModel().get("error")), equalToIgnoringCase("El monto inicial no puede ser negativo."));
    }

    @Test
    public void crearSubastaCuandoServicioLanzaExcepcionMontoIngresadoNoEsValido() throws IOException {
        // preparación
        when(sessionMock.getAttribute("USUARIO")).thenReturn("aguspucci@unlam.com");
        when(requestMock.getSession()).thenReturn(sessionMock);
        mockFile1 = new MockMultipartFile("mockFile1", "mockFile1", "image/jpeg", "/9j/4AAQSkZJRgABAQAAAQABAAD/2wBDAAoHCAkIBgoJCAkMCwoMDxoRDw4ODx8WGBMaJSEnJiQhJCMpLjsyKSw4LCMkM0Y0OD0/QkNCKDFITUhATTtBQj//2wBDAQsMDA8NDx4RER4/KiQqPz8/Pz8/Pz8/Pz8/Pz8/Pz8/Pz8/Pz8/Pz8/Pz8/Pz8/Pz8/Pz8/Pz8/Pz8/Pz8/Pz//wAARCACWAJYDAREAAhEBAxEB/8QAGwAAAgMBAQEAAAAAAAAAAAAAAgMBBAUABwb/xAA6EAACAQIEAwYDBgUEAwAAAAABAhEAAwQSITEFQVETIjJhcYEUobEGM5HB0fAVI0JiciRSc+E0Y/H/xAAYAQEBAQEBAAAAAAAAAAAAAAAAAQIDBP/EAB4RAQADAQEBAQEBAQAAAAAAAAABAhESMSEDUQQT/9oADAMBAAIRAxEAPwD5xWrzugg1FEGqK4vVCi1QRm0oALUCy1VCWagUWoAzd6qGq1QGpoDBoCBqKdaOtUb/AAs6CoPqMGdBWoRq2j3a2jyENXMFnoOL0VGfzoBziggvQLL0AM9AlmqoWWoAza0DFagNXqA1eijDUDrba0V9Dws6CoPpsI2grSNW03drUSjx4PWRPaVBGegjPFXDQm4OtMTYAbw61eZOoAbwq8ynUANwnYGrwnUAYt0NOE6Ac/SrwdBAedqcnQwT0NZ5lroQJqcyaYGIqYujV6KfafWor6Lhjd0VFfS4R9BVGpbfu1UePd6unDl0IK5EgU4TpIs3G2BrXCdmLg7hPOrFU6MHDnJ2NXlNT/DwvjIHqaZEH1IwlnndQe9NgyRrgrf9Lofer8MkfwAOwn0q5CaIcPWNVM0xNSvDgB4auGp/h45LTDXfw4RJApya4cOVt1qcwvUlvwtdYMVmfzhqLyBeHONVNYn8/wCNR+jTwU2oDcq5zSYdIvDfwd0EDWpktbDUt3NKK+IThgjUTXs5ePT7fDV5inJqwmAC6AVcRaNvgmCATG40/EHdLayE9T1rnNv46RX+k3MPw/EAnD8RT0bSsTOtxEELwq4jZ7Rw9/SIJqYqrisDiQpAwmXn3NRUxdZNzD48EjtFtr/xkmmJspw9lrTHPiGuM0b6Ae1BZD3l8Nxx6GrspkDGMxKiO0n1ANXqU5ga8RvjRktt7RV7lOIH/FOT4f8ABqv/AETga8SsEEMlxfYGr3CcSn47BRDXcs/7lIq91TmVm2EuJnssrqeamRW4+sj7PkRTAajIO6TNZyF2TreJujQMazP5xLUXmF1LYJJy+9dnMQsCTUFbHN8Pgr1xfEiEj1qW8WvrzHG4xrd7UZ3bvEk1wiHYpeIMvitkehpgfY4s6GRfur0FMGnh/tHik8OKn/I1FXrf2lxDL/MVLg9JoDxnH8BYs5cRYD4k/wBCAAJ6nr5Daqaxv41auNI7vkAKmGmJxFGHjA9yKYHJjJ2IPoQagg4tQCTE+sUVXuY+0BGxojPv4tnJg6UDuE8Su8Pxq3QxNpiBdSdCOvqK1WclmY2HoSsrEQN+dehxHAPKqJZY2iiNrsgoMamigyQdKClxVQeE4rSD2bVm3i19eSY4f6lf8R9TXGHWV8IpQSAdOlaxnS2wtkjVR7aVMNV2wVo7Fl+dRdRh82FxYAbMCpI9RtRYlRE3r5k7moqw2FQLJaPWgX8Mw8LfUUHZMQnMn50BW775styQeRoOuS2p3GhFRXKe7rypiHX8NfsWVe9aZFuAlc2k1cHpuDXLh7QYRCKPlXpcDoInKRRBKg5a0GuSuaCaKhbWYkzpNBU4lP8AD8SkT/KbX2qT4sevIOIffof7fzrhDrLRtrNtfStuYyFiKBRUcqiqd4RjF/4zUlqFDDfeSdhrWWlnPLFn0AGp+gFBDusSLYA/tJkUUyzc2Eyp0BogMYsWw3OaALnjbzUUFzgiB8U6lFZjbfKW2UxoaB/FVY4m3aNq4gZiZutLuSQMxHLbQdKsJL0NQEEchXpcDNmBnfkKgksCYzaig1TBTvGfaqrgwzaEgxtFQIxzzhryldTbYTGmxqT4sT9eOcR++T0/OuEOstK0xFpdOVbc3EnoKASZoKV8/wCsH/EazLdWfYE5vSstHXvuz/n+WlBKsDbCqu+5iaAE8bL5GgdjDmsIf90GgG594/oBVRa4ZcSwbtxrzWiEhcqyW1Gg6bb0DcO3xnGcNCxmvKNTJPenU8zVr6k+PTEIIjeu7ihgmpmPSgi32aEgvQbEKQWGh6nnRSyzSVKEg9eVUKupNm4qSsodAZ5VJIePcTEXEPLUfOvPDtK1YuB7Kww0GutdIczG12FABPWoKl7/AMuP/WazLdVPCfeCay0sXLcArEiPlyNAgWn2RgR1mKoNLUMVDAuRrGwFA3GrHZIORioFXPHc9aqBLFVAG519KI1Ps2mfjmEDGQLhafQE1qvqW8ekqcoEwdNSK7OSTDgjNp5UAMpGoKkdTzoNa4JeCdCZ0oqGJfRFZYOubeaAWAysCCDGwoPJcQiu7q4kZjXmdyrnDgtpbqm7aRjCswlSfWrqYULWLtj+XcW4Ogb8jV1MCcVctmL9or6iKupiLTi9jARMBSDWZagprL27pKCdZAqKZ8SPDdtsp8qA1fDOe8w911oHgoqRZSP7tPkBQVMSZv2l5gzQIdu+3m1VEE9/0UUG99kUL8atkDwW3b5R+dbp6xbx98Lik+EabMv611c3BwwJgHUxl3oDXLcAKAN5NRWndYdpq+sx3aBJvlhnaQRoPUen1oOzgABSzQdlNB5lxSw+F4nfs3FIIckTzB1FcJjJdonYXsFfwicPtzct/F5gmW4kiC/Xymd661pS1ffrha/6Vv8AI+LOIw4F8YYYS1iCF7RnDgM4Jga5d9Ks/wCe25H1mv8AqpztvjKvWLa4drlu46gTCvGsNEeZ57RXGazHsPRF628lTzcgFHooH0rLQWCsIYTQJuB1HdOYdGE0FfNabx2o80MVRK2rRPcvlP8AIfpQE4w+HXMt037p5xAH46mgpAnMSd6BgjNJoj6X7HnLjcTdjw2gJjaW/wCq6UYs+uN8BVVhrzhvP/utuZgvEklh3CByA9hVVLFH/wBz+an5aUGqrkWwEUkHf23+dAIzMzEAztMiCKBYDWTNtwQviSdh6/WgyeK8NwvFcOZJ+JURbcNqNJg9RUmNWJx8Vi+GcTwSzewxdNIZDM1ymkukWhVs4xrFybb3LFwaaSppW1qzsSlq1vGWjVk4++/DzgyytaJBmNfFO/rW5/a805lzj8KRfuPVea4u7qDjqKCs1vvbc+k8z0oAa1QLa3FAhtCao7NRH0fAitjCsx+8uGdDqOgrpX4xb1prjHBLZx4pPU1rWFy3ixIBaOcTpV0W/i1BGXu+WaIoN3NdZ3a3ICgAwwA9+lUKZyqks+Y7kKZ06zt5+9APbDLOgy6d6df19fKgIZAG3yx4T3TPT8qAWGaZMxHLXz0/LzoKN7h2FxbZL9lHWea69Tr+FTIGFf8AsvhnZvhXu2jqBqCD+NZmkNRaWTiOCcSwwJXs7wG+VtazxLUXZ9x7lhsuItPbPmKxmNbqVuo2zCootIoIIoFuoAJoM5z3jVHKNagtW7hBkEg1WVm3iri7mZppiwmOYdKvScnrxAEQavSY9CLMQG1NxdwdhP7512YC4K3O4NBowBjXr5c6AFuAN37pZfXfX66fuKCZV5cTEyNZPlRQlgmoJyyIkbT18tNqIhQyCH0DankDzFAtypOuVuobWP3E0BqyP4mLMsnMSPcgbc/nQV8RhLV9lIBYEwwy6/vagy8XwDAYhMy4fs21h7U6ms8xKxMsXE/ZzEWS/wANiM4TUhxyrM0aizOu2MdhzF3DlvNdaxzLXUKV7EFhAUj1qNK4Uk60DVWogwsedAQHI0EgQaAgfKg9TbMzZ1IIBOrDkNZPn5Rz8q9LikE5Sot5iBGhBnrUCigtBkOXXbWdD70VHaKUzKZGgcroB5fh+VEc85gueF2gKIOm3sDVAqFtWxqM51DCdtveP+6CQhK5lgakhW/q1jnz6UC8vZspQMV0kZdRrvJ3k/SgaIQZSVYMYgiQOf76UC3uq5Bt8yCMsnbcj5fpQJlDnLKSADuRAPLTrQKuIAxJhmfduQ0IE9KCpe4bhrqk3LakyFXSf3oPnUyF1mYjglkKCinWTAEkddazzC6qXODKNbZJXSCDPt86nC9K78Pa0ZbrGpqcnQWwTRI261OV6d8C48QNOTQ/CNO1OTXptxrSg3DG0nMdPP3/AFrs5qxYkkESCJ3jWdSelBJXMQrOrBgRA68qARakG3GUZTAfwnTegIMEzAiV2hjEachQDdYq4Kq3ow2/Sgm53nuABu956v5+WvKgC4CpOYgs2hgwGG3p+sUAlVZzBMz4WMCOfp+VAKdm2sQiiTm0AE7+Y86Dm0IAK5pmNI6/SKBKM4BJYHLsDrlb896CRCkwzHNoWnfWghsvZuEBKloYxI3/AAoAcBgbiqCHhchEA+nWPSgrm0CSyox/tI27xiOZ9N6gr/DiSqsvd1BA55uQ/WgU2GGXMWJO++p9+dMUKYYHojDeY08vKpg+tTM5OwIAykrJB31P19q0iWVAVuQY0lNwvKenXTnUAMQA082OYHnH709J61RJRbZBfvLAyzoJnUfiNqBbHUsqjQZc22cE71B11/6kJuf0QNZM86og22SWXvK2hbc78/xNBylGtlFKl4KmTM8p8hP5zQKUmQ2dS8aZTpA038zQS+RoYSZMARqCOZPl0moEvpndgFDMCQrTM7R+nnVEdmcoMS2kE7QJM/jQcwYEMwdzuJiBoNPXTlpQCrsAO0Ihh3SdDz1/cUCwVc57ANqGkNs23IUBIe3YB1yZoOhJGnPp9aBTWigAugiR1g+vTfnQSDlRgoVRlEtGgEfhPzqBRw8kqpRAuktGvPn6z70G2l221y9aCsFTvAkyTJ2+tUMWTeNomZggkdRH5RUBKAVGUEBttYjSYopFtu/cUkkMwBIAB5ifaqg7YVw1phDyQGGwPWoF9oZKqiqBCxMjaR++tUDZUC52WjLIMMInzMbmfpQC9sWnLgAquaBEZcsD6mgLEThpykqdww1Ij/7QKsHt2VEHfbutmOkDf50EC2CwVgGXKXPKATGg60HOjkFmytcjMSRuOvrp6UACAQuiygLFV1iNI/SiFW2bNbLxNyZgc4PPf3+VAFwS8AmSxUE+1A97a9qFOzoGnmBP1oqUd0CFzKMYBJlgOkmgjEYbJcZUyhi2UyJ13BqCu9hSs3SWnWY1oP/Z".getBytes());
        mockFile2 = new MockMultipartFile("mockFile2", "mockFile2", "image/jpeg", "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".getBytes());
        multipartFileMock = new MultipartFile[]{mockFile1, mockFile2};

        // Configuración para lanzar la excepción
        doThrow(new RuntimeException("El monto ingresado no es válido"))
                .when(servicioSubastaMock)
                .crearSubasta(any(Subasta.class), any(MultipartFile[].class), anyString());

        // ejecución
        ModelAndView vista = controladorSubasta.crearSubasta(subastaMock,multipartFileMock, null, requestMock);

        // validacion
        assertThat(vista.getViewName(), equalToIgnoringCase("nuevaSubasta"));
        assertThat(String.valueOf(vista.getModel().get("error")), equalToIgnoringCase("El monto ingresado no es válido"));
    }

    @Test
    public void crearSubastaCuandoServicioLanzaExcepcionSubastaDuplicada() throws IOException {
        // preparación
        when(sessionMock.getAttribute("USUARIO")).thenReturn("aguspucci@unlam.com");
        when(requestMock.getSession()).thenReturn(sessionMock);
        mockFile1 = new MockMultipartFile("mockFile1", "mockFile1", "image/jpeg", "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".getBytes());
        mockFile2 = new MockMultipartFile("mockFile2", "mockFile2", "image/jpeg", "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".getBytes());
        multipartFileMock = new MultipartFile[]{mockFile1, mockFile2};

        // Configuración para lanzar la excepción
        doThrow(new RuntimeException("Ya existe una subasta con los mismos datos."))
                .when(servicioSubastaMock)
                .crearSubasta(any(Subasta.class), any(MultipartFile[].class), anyString());

        // ejecución
        ModelAndView vista = controladorSubasta.crearSubasta(subastaMock,multipartFileMock, 100F, requestMock);

        // validacion
        assertThat(vista.getViewName(), equalToIgnoringCase("nuevaSubasta"));
        assertThat(String.valueOf(vista.getModel().get("error")), equalToIgnoringCase("Ya existe una subasta con los mismos datos."));
    }

    @Test
    public void crearSubastaCuandoServicioLanzaExcepcionLenguajeOfensivo() throws IOException {
        // preparación
        when(sessionMock.getAttribute("USUARIO")).thenReturn("aguspucci@unlam.com");
        when(requestMock.getSession()).thenReturn(sessionMock);
        mockFile1 = new MockMultipartFile("mockFile1", "mockFile1", "image/jpeg", "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".getBytes());
        mockFile2 = new MockMultipartFile("mockFile2", "mockFile2", "image/jpeg", "/9j/4AAQSkZJRgABAQAAAQABAAD/2wBDAAkGBggGBQkIBwgKCQkKDRYODQwMDRoTFBAWHxwhIB8cHh4jJzIqIyUvJR4eKzssLzM1ODg4ISo9QTw2QTI3ODX/2wBDAQkKCg0LDRkODhk1JB4kNTU1NTU1NTU1NTU1NTU1NTU1NTU1NTU1NTU1NTU1NTU1NTU1NTU1NTU1NTU1NTU1NTX/wAARCACWAJYDAREAAhEBAxEB/8QAGwAAAgMBAQEAAAAAAAAAAAAAAwQBAgUGAAf/xABBEAABAwIEAwUDCQQLAQAAAAABAAIDBBEFEiExBkFREyJhcYEykaEHFCNCUmKxwdEkM3LwFiU0Q1Njc4KSsuHx/8QAGgEAAwEBAQEAAAAAAAAAAAAAAAECAwQFBv/EACYRAQEAAgEDBAMAAwEAAAAAAAABAhEDITFRBBITQRQiMjNhcYH/2gAMAwEAAhEDEQA/APPK852F5CkCsh3SMnKUGVed0gXJ7yZhynvJwLMKCFaUgsCgLXQFmHvhAa1OQGIIeNwzbpUH4iC3dSbd4ab+3E+C24p1Z59nT1tQI4DrrZdNrGRixVQbG7xKmU9BuqO8d0bGnJvK525eQ6FIE5Sgych3SMrId0Au46oAcjtU4F2HRMCNKQEB0SC10AeB0YF3bpU4bjqIxpmU7GjUNRADc6p7GmhDiNKwWc34KplE2Vp0XENHTOu1pB8Arx5JE3C1ojiuhl/eX9Qr+XFHsojOIMMdzA9E/kxHtozcXwt49tqPfiWq4t5WTUtIUgUlO6DJylAKyFEMu52qYDedUBZhQQzSg1gUaCwcloIdcjdABIkB0cUaCWyTN+sUtQ90UVMw5kpe2HtdtbMEvaNrjEJQl7TEbicg3CPaFxijuYS0TckctmZWU7oBWQpGTlTBSQoBc7oCjzqnAswoAzTokFgUBYICUG9ZASGqQsGpKSGBASGBIJEYKQW7IIDdkctWRaQoMrIUAs9j3k5WOPkFO5D1VBhtVKe7C71U3kxn2qY2jw8M1kvtWas76jGdlTjp6Lg4lwMshPks76m/UXOLy0YOE6SMatzKLzZ05hIP/Rum5RhT8mfk/biG/hiAjRtkfLnB7MS7+FGH2XEKp6jIvjxBfwnIPYkWk9R5ifjLv4Zq2nu2KqeohfHQXYFWs/ur+Sv5caXsoEmH1MXtQv8Acn78b9lqhZHNJzNI8wnuUIBQFmlILghAdQMLDtXOK576nwucIjcIh5i6n58qr45ETU9FRNDpzHGCbAuNrnoFEy5M7qHrHGbpWXGcHpbF87NfstJ96v4Oa/Sfk44PDjWHSMLhNkaCAXPYWgX23CPx+WfQ+XDyeqJYaOB008jY2N3c42CymFyuou5a61zUfyi4XLM2OGOV5ebC5a3W/iuv8LPyw/JxdDRYrSVkBkiqYiG+0C8d0+Kwy4ssLqtcc5lNxZ2MYdGO/iFK0j/Nb+qU4s72g9+PkB/FWERe1iNO7+Ek/gFU4eXwXyYeQncaYKxpcalzgNy2J36K56flv0m8uHkF3ygYM0d0VDx1EVh8SrnpeRPzYhu4+w9wvFS1DvMtH5qvxMvJfkYpZxqyQ2jw+T/c/wDQKp6K+U/kzwYix2eoI/q1pB+8f0V/hf7T+T/poUrIa0OM1A6G25dYj3/+LLP0vJhNtMefDLotJgWHy7xAeQXNM75baLScIUco+je5nkVc5Mk+2FZOCzf6Oo08Qr+SlpqiM8lw6dGy+IVrMMw+aqmDiyJtyGjU8tFeGFzymMTllMZt8v4q4nqMbp448sbGRyZ2iO+YGxG5K9n0/BjxW2PP5eW59HOskqXnMXzutzNyuvTD/wBbME0U9OW1k1XcDRthlJ8e8g/1TimI1uJUpinxKZ7bh2R77i425rLDjwwu5DyzyymrWJ2MrPrsJ6h2q16Ia9LVUzKNrKuSSeRoLW95xa0bi3xSs2N2FXVEcdix7r8wG2CPaNjR4tThoaaR8j+vaWv7gn7YN01HXQZc0lJTxj773OKNQdTVPjNJ7IhjaerKfN+JQNVqwSVdTGXYdiFGwAaNmg7Ek9LkFvxR1LTOxLEeIcOlEdXLPTlwu0hrQ1w6tI0I8iptpyQg/GcTkHfr6kj/AFCEt1Wo0uF6iqqMagZJUTSNdNHdrpCQe8suW/pWmE/aPrjRe92rx3oPFjhsLJB6z0wSEl+Sy2rTN4lDXcL4hmIy9gd1rw/5JpHJ/NfG6kDMRuPFe3HnV6lYJJGMc8Rsc4Bzjs0E7+iZSOrreGqSPGpKGGGSOKI5mVEkwtUMa0ucWnYl31Q0ac1Et1tWpsy/AOHKYyCoxA5BI7K9s7SezzxWOUDU5Xv/AOJ6I3keoUqIuF4YJm3Y6YMsLSPeA/sn+yRuM4Ydeqf7F+rkWublOZwBt8VsyLukzHRMhGSdmLNF3HmgCNBvmkNyo34XJ5W+cNabDU+CNUbh2ixGeid2kYnjH2o3OCNUNqLiZtVSOhqAyaJ2pa5ttepA0v8AeFneJ2S35GiBhgveIOc07Xdt4aJH1bXCbYxjMIsIx2rLvDrEa9eSy5bZhdLwn7Tb6nQVckuHwSVDSZXsBcSLEleVcuvV3SeDHzhl9Wpe6DVWEkZVSwdWQ1c0as7idgdwxiAH+CT7rLbh6Zxnn1xr5LW4e2KmEzZnF2UOcws0FzYWN17WOUrz7jYXpo2uYSSdFpqIFyMAtlv5lGhtF2NGjGoJSSYNBsAPQJglPM5+lyqiQm6C+6AZjjEUed/tH4LO33XUaSam6Yhoy+FtRUENjLhliv3pBfVPeuwk31p2KqEAAp4I4wPu3J81G1f8Wgq442hroha1r/n1/wDqZFqumIjNVAc7QRnI6n+d+acu+lGvuLUMuZ4bydp/P881F6G6/gWMPx+G4Fg6/wACsOe/pWnHP2fUgzTqvN07NoyA6FII7Ft0ag2zGWN7G4WMaEseGbh6va3f5u/S3gtOP+4jL+a+R11Y2SmEYjIJja299LA6L2sMdODLLcL0NTFA7LPHnjJ1sbELaVjY2qfCqbFIr0cpa4C5v+iqSVO7GPXU0tDOYpm2cOfIpa0qXZGRxKAA4blOENTQ55BcaNF/VTldRWOO6ZhZHLV/TEdlH3nC9s3h+aU6RXeiTVMtTM57z4AAaNHRSao1539UgtkFjdqAijmMRmAALXd2x21CeQx+1qJtpAB9V1vipzp4x3fADAcdOns5vwK5vUfw14v6fSGg220Xnutba+twjsTwI52RsMrQAkLBoWxOz8HqwNSYH/8AUq8L+0LLtXxapNy06+zz8172LzMizVSDuF1smH1zJYnEa2I6hOXQs2LjlQZ6ze/RXanGaZTlMMI6i3iqJoU7QI5CPtW9ywy7xtO1UhF2k/acfx/8VXuUEEZJuNdUB4jqkbznEMOuiCCpfZeer08ixHw7vT35F1/S6jkXg735OyTiUr7bNcfwXL6rpg14euT6K2W4tZef7nVpcFp3GqroFcgI3S0GLn1C5ttQqhwfSTNuReNwt6FVjepXs+MVTrvt4FfQ4dnlZF2nVWiCMNnjzQpaueXVJJVfSCzkGC7Q/FUlo0rg6N48fxWGXSxtOykWmZvNrlVKCmwcWuaQ7ojRbXEcpbpHLbxbp8UaGwpIZcpBDW+bh+RT1C3QzE+mgbnFjKMzehG1/gjvT7Q3SM7KEu20sPzWd61c6R3HyeEioqDa9mHT1C4/V39Y24O7umTDRtyD0K83br0Oxxt3vcqhCBwtrpdXCcsahrHGz/iuVun5217HNzC7hbU9U4mvj05LZi127SQV9Lj2eRl3DYqSKz2h5pGmr/tB81X0kAoMN7bhOEJTS5HWJ0tYqcptWNMi7ZxK1gkLT3mHZwROs0L0p/t3Ttd2Ez2iNtzG45S07kAdApu4qaqj6SpDS57HEAXJceSk9APkhha8OeXyjRoZsCDzPRVJaVsgQz1E5llIu7XawHoi3U1Ck31rpqGughbTDD8KdUPjDS8uaHZnC/MDYk/Bc16f1W0/1HT8E4RX0kc09TC6Iy6AP0cdb3suP1PJjnJji34sLju5Opa2RoJlaHW8Fxdft0DNlaGi9xdVKWhDIw7WHoq3C0+SPrJQT33e9bTjg91LS18wbo93vWuPHii5VzU+YVD829yV6mH8vOy/p5hTpQVhs4eaR7WrXftBKqdk0sXJjahffxQSAHXu1p9yOhzZqCcsINy1w2PMKP8Ai+7T+fQVEIE9JFI4aB7DY+79LKpl5TrwTmMb3WYwjwJJ/NL3Q9U5hnD1XXvBbE+OLnI5pt6Bc/L6nHCd2uHDlk+h4Lw1h9JC0fNWPeNc8gD3Erys+fPO93djx44zs6OnjZELMY0Do0WCyUaDrm5Nk4SwbYkEXBRoKlsfM2RqH1Q6EO1v63S0Nvnr8Ea7UhVOSxfthaTh4vvYkK5z2IvHGVW8IVE2sZFxsurj9ZMe8YZ+n93ZlnhbFIzYRNd5OXVPV8Vc34+cFi4axEu+kjbGOpKV9Vx/Sp6fP7PN4QfO7PJNdx5DQLG+t12i56bzRG8HNZoW3PjqovrMquenxhqHhIO6AeCzvqslzhhiLg2nLvpC/qbKfysz+HFq0/AeESRgvZI7S+jil+Ty+T+HDwOz5P8AB2G4gz/xOJSvqeW/ZThw8H6bhuipAPm1LCwjazRdY5Z55d60mOOPaHREIT0HNRpQ0fZl1rAnwT0RgR5QLG45JyFsTKd7XT0EBzedx5pBfNoLi9+aZK2t+709Ea8G52wDraElYbar9iDy8EbCDTZRsPNPYSIGP3tcaXRstJdQsNxYWt0T9w0q2ha3Xmj3DQgpe5e1/RGxpZlO0OsN/JEoENM1wsU9hLG9iLNJAS2NGWSDkb68uScqdLtcQ6+5O5CexoZpDx3hcDqFUpKupWub3Ra/TkgIdBJFrGc1jslqwdFo6zJ3X913Ryfv0PaPmimYDYbe9VuVOrFTGRc9UtG80B1g8cuQT35DBfDmAyhubfXmuVqCHmF9iNNtUGbilDgAHCyeyWMALjbulMPMeW7jQ/BKUaFGW3OyeyXBa5PYR2TS0EX1CAlpsCCL6c0bDxjaWW1sNUaAV+zdZv4pAWCpaRZ+jtvVVKVhprwRpqPBUWkiU200PinstCMqA6wcnMhpDo2v1sPcjWxsMxGNpLSQB05KdaPY0cuUEOIfY8lcy8p0Idu7qPJV/wAJgRuBBzHUD1C4o3RJC11yNQUwDYwnvahAMQyt5lOAxbOy418UyeylgtyQEhoOo3TJIdre+3uQBWgHe10yeMdgSNuaehsKRjT3troOFZKfLcZrka6paC8FR9onPyA5olFPsnbJo7mr3tOniAfZ3HLmkHhK8O7xIvbQo3RoZs1tFUyLQha19yCGnqq7kGHyNcQBe3MJbsNjODdDqCTyXI2WBJuBa6YQ8AaHVMgnxgHO24PRAg9NUXG2oNkSiw1YO1VxL3ZnNvsjQ2lrA4HRE6hX927Tbml2HcVsmbSyqUliy+/r4qtAF0ethbXTZLQLSRXaS2zS0dEtHsOnmJcWnQ2v5pQzkNQS+xVS9U2GHWmBvv1Vdy7BPjdG64dtsp1o9iMmL2kjQjROXZLNlJJzcuYT35Gn/9k=".getBytes());
        multipartFileMock = new MultipartFile[]{mockFile1, mockFile2};

        // Configuración para lanzar la excepción
        doThrow(new RuntimeException("El título o la descripción contienen lenguaje ofensivo."))
                .when(servicioSubastaMock)
                .crearSubasta(any(Subasta.class), any(MultipartFile[].class), anyString());

        // ejecución
        ModelAndView vista = controladorSubasta.crearSubasta(subastaMock,multipartFileMock, 100F, requestMock);

        // validacion
        assertThat(vista.getViewName(), equalToIgnoringCase("nuevaSubasta"));
        assertThat(String.valueOf(vista.getModel().get("error")), equalToIgnoringCase("El título o la descripción contienen lenguaje ofensivo."));

    }
}
